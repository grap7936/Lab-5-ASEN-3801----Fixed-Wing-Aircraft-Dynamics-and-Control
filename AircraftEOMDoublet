function xdot = AircraftEOMDoublet(time, aircraft_state, aircraft_surfaces, doublet_size, doublet_time, wind_inertial, aircraft_parameters, control_input_array0)

%% Purpose:
% Define derivative of a state vector of 12 x N components for input into ode45 to achieve a final
% state vector and how it evolves w.r.t time with a doublet added to elevator control input

% Inputs: 
% 1.) t == time --> time steps will be decided automatically by the computer when used in ode45
% 2.) aircraft_state == state vector of 12 x N that will be numerically integrated to solve for by the computer
% 3.) aoircraft_surfaces == vector of four aircraft surfaces including [delta_e, delta_a, delta_r, delta_t]^T
% 4.) doublet_size == size of doublet portion added to elevator control surface, delta_e
% 5.) doublet_time == time the doublet pulses in conjunction with the elevator control surface
% 6.) wind_inertial == the wind vector expressed in inertial coordinates as: [w_x, w_y, w_z]^T
% 7.) aircraft_parameters == necessary coefficients and structural parameters of the twistor aircraft
% 8.) control_input0 == initial conditions for controls read in to determine trim variables. Has 
% form [delta_e_trim, delta_a_trim, delta_r_trim, delta_t_trim]^T







%% Insert rest of original AircraftEOM HERE!!







delta_e_trim = control_input_array0(1);

%% Create if statements to define delta_e with respect to time (i.e designed as a piecewise function)

% Preallocate variable sizes
delta_e = zeros(1, length(time));



% Loop

for i  = 1:length(time)

if 0 < time(i) && time(i) <= doublet_time(i)
    
    delta_e(i) = delta_e_trim + doublet_size;
    
elseif doublet_time(i) < time(i) && time(i) <= 2*doublet_time(i)
    
    delta_e(i) = delta_e_trim - doublet_size(i);
    
elseif time(i) >= 2*doublet_time(i)
    
    delta_e(i) = delta_e_trim;
    
end

end
end
